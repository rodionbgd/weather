/*! For license information please see slip.js.LICENSE.txt */
window.Slip=function(){const t={container:{role:"listbox",tabIndex:0,focus:!1},items:{role:"option",tabIndex:-1,focus:!1}},e=/Chrome\/[3-5]/.test(navigator.userAgent),i=e,s=e;let o=document.createElement("div").style;const n="transition"in o?"transition":"webkitTransition",a="transform"in o?"transform":"webkitTransform",r="webkitTransform"===a?"-webkit-transform":"transform",h="userSelect"in o?"userSelect":"webkitUserSelect";o[a]="translateZ(0)";const l=o[a]?"translateZ(0) ":"",c=o[a]?"translateZ(1px) ":"";o=null;let d=0,u=!1;const m=function(){};function g(e,i){if("string"==typeof e&&(e=document.querySelector(e)),!e||!e.addEventListener)throw new Error("Please specify DOM node to attach to");if(!this||this===window)return new g(e,i);if(this.options=i=i||{},this.options.keepSwipingPercent=i.keepSwipingPercent||0,this.options.minimumSwipeVelocity=i.minimumSwipeVelocity||1,this.options.minimumSwipeTime=i.minimumSwipeTime||110,this.options.ignoredElements=i.ignoredElements||[],this.options.accessibility=i.accessibility||t,this.options.accessibility.container=i.accessibility.container||t.container,this.options.accessibility.container.role=void 0!==i.accessibility.container.role?i.accessibility.container.role:t.container.role,this.options.accessibility.container.tabIndex=void 0!==i.accessibility.container.tabIndex?i.accessibility.container.tabIndex:t.container.tabIndex,this.options.accessibility.container.focus=void 0!==i.accessibility.container.focus?i.accessibility.container.focus:t.container.focus,this.options.accessibility.items=i.accessibility.items||t.items,this.options.accessibility.items.role=void 0!==i.accessibility.items.role?i.accessibility.items.role:t.items.role,this.options.accessibility.items.tabIndex=void 0!==i.accessibility.items.tabIndex?i.accessibility.items.tabIndex:t.items.tabIndex,this.options.accessibility.items.role=void 0!==i.accessibility.items.focus?i.accessibility.items.focus:t.items.focus,!Array.isArray(this.options.ignoredElements))throw new Error("ignoredElements must be an Array");this.cancel=this.setState.bind(this,this.states.idle),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onSelection=this.onSelection.bind(this),this.onContainerFocus=this.onContainerFocus.bind(this),this.setState(this.states.idle),this.attach(e)}function p(t){const e=t.style[a];if(e)return{value:e,original:e};if(window.getComputedStyle){const e=window.getComputedStyle(t).getPropertyValue(r);if(e&&"none"!==e)return{value:e,original:""}}return{value:"",original:""}}function v(t,e){let i=0,s=0;for(let o=0;o<e.length;o++)1===e[o].nodeType&&(s++,e[o]===t.node&&(i=s-1));return i}return g.prototype={container:null,options:{},state:null,target:null,usingTouch:!1,mouseHandlersAttached:!1,startPosition:null,latestPosition:null,previousPosition:null,canPreventScrolling:!1,states:{idle:function(){return this.removeMouseHandlers(),this.target&&(this.target.node.style.willChange="",this.target=null),this.usingTouch=!1,{allowTextSelection:!0}},undecided:function(){if(this.target.height=this.target.node.offsetHeight,this.target.node.style.willChange=r,this.target.node.style[n]="",this.dispatch(this.target.originalTarget,"beforewait"))var t=setTimeout((()=>{const t=this.getAbsoluteMovement();this.canPreventScrolling&&t.x<15&&t.y<25&&this.dispatch(this.target.originalTarget,"beforereorder")&&this.setState(this.states.reorder)}),300);else this.dispatch(this.target.originalTarget,"beforereorder")&&this.setState(this.states.reorder);return{leaveState(){clearTimeout(t)},onMove(){const t=this.getAbsoluteMovement();if(t.x>20&&t.y<Math.max(100,this.target.height)){if(this.dispatch(this.target.originalTarget,"beforeswipe",{directionX:t.directionX,directionY:t.directionY}))return this.setState(this.states.swipe),!1;this.setState(this.states.idle)}if(t.y>20&&this.setState(this.states.idle),t.x>1.2*t.y)return!1},onLeave(){this.setState(this.states.idle)},onEnd(){const t=this.dispatch(this.target.originalTarget,"tap");return this.setState(this.states.idle),t}}},swipe:function(){let t=!1;const{container:e}=this,i=v(this.target,this.container.childNodes);function s(){e.classList.remove("slip-swiping-container")}return e.classList.add("slip-swiping-container"),this.target.height=this.target.node.offsetHeight,{leaveState(){t?this.animateSwipe((t=>{if(t.node.style[a]=t.baseTransform.original,t.node.style[n]="",this.dispatch(t.node,"afterswipe"))return s(),!0;this.animateToZero(void 0,t)})):this.animateToZero(s)},onMove(){const t=this.getTotalMovement();if(Math.abs(t.y)<this.target.height+20)return this.dispatch(this.target.node,"animateswipe",{x:t.x,originalIndex:i})&&(this.target.node.style[a]=`translate(${t.x}px,0) ${l}${this.target.baseTransform.value}`),!1;this.dispatch(this.target.node,"cancelswipe"),this.setState(this.states.idle)},onLeave(){this.state.onEnd.call(this)},onEnd(){const e=this.getAbsoluteMovement(),s=e.x/e.time,o=100*Math.abs((this.startPosition.x-this.previousPosition.x)/this.container.clientWidth),n=s>this.options.minimumSwipeVelocity&&e.time>this.options.minimumSwipeTime||this.options.keepSwipingPercent&&o>this.options.keepSwipingPercent;return n?this.dispatch(this.target.node,"swipe",{direction:e.directionX,originalIndex:i})&&(t=!0):this.dispatch(this.target.node,"cancelswipe"),this.setState(this.states.idle),!n}}},reorder:function(){let t;if(this.target.node.focus&&this.options.accessibility.items.focus&&this.target.node.focus(),this.target.height=this.target.node.offsetHeight,this.options.ignoredElements.length){const{container:e}=this;let i=e.tagName.toLowerCase();e.getAttribute("id")?i=`#${e.getAttribute("id")}`:e.classList.length&&(i+=`.${e.getAttribute("class").replace(" ",".")}`),i+=" > ",this.options.ignoredElements.forEach((t=>{i+=`:not(${t})`}));try{t=e.parentNode.querySelectorAll(i)}catch(t){throw t instanceof DOMException&&"SyntaxError"===t.name?new Error("ignoredElements you specified contain invalid query"):t}}else t=this.container.childNodes;const e=v(this.target,t);let i;const o=this.target.node.offsetTop+this.target.height/2,d=[];for(let e=0;e<t.length;e++){if(1!=t[e].nodeType||t[e]===this.target.node)continue;const i=t[e].offsetTop;t[e].style[n]=`${r} 0.2s ease-in-out`,d.push({node:t[e],baseTransform:p(t[e]),pos:i+(i<o?t[e].offsetHeight:0)-o})}function u(){this.updateScrolling(),i&&(clearTimeout(i),i=null);const t=this.getTotalMovement();this.target.node.style[a]=`translate(0,${t.y}px) ${c}${this.target.baseTransform.value}`;const{height:e}=this.target;return d.forEach((i=>{let s=0;i.pos<0&&t.y<0&&i.pos>t.y?s=e:i.pos>0&&t.y>0&&i.pos<t.y&&(s=-e),i.node.style[a]=s?`translate(0,${s}px) ${l}${i.baseTransform.value}`:i.baseTransform.original})),!1}return this.target.node.classList.add("slip-reordering"),this.target.node.style.zIndex="99999",this.target.node.style[h]="none",s&&(this.container.style.webkitTransformStyle="preserve-3d"),u.call(this),{leaveState(){i&&clearTimeout(i),s&&(this.container.style.webkitTransformStyle=""),this.container.focus&&this.options.accessibility.container.focus&&this.container.focus(),this.target.node.classList.remove("slip-reordering"),this.target.node.style[h]="",this.animateToZero((t=>{t.node.style.zIndex=""})),d.forEach((t=>{t.node.style[a]=t.baseTransform.original,t.node.style[n]=""}))},onMove:u,onLeave(){i&&clearTimeout(i),i=setTimeout((()=>{i=null,this.cancel()}),700)},onEnd(){const t=this.getTotalMovement();let i,s;if(t.y<0){for(i=0;i<d.length&&!(d[i].pos>t.y);i++);s=i}else{for(i=d.length-1;i>=0&&!(d[i].pos<t.y);i--);s=i+1}return this.dispatch(this.target.node,"reorder",{spliceIndex:s,originalIndex:e,insertBefore:d[s]?d[s].node:null}),this.setState(this.states.idle),!1}}}},attach(t){d++,this.container&&this.detach(),!u&&i&&(u=!0,document.body.addEventListener("touchstart",m,!1)),this.container=t,!1!==this.options.accessibility.container.tabIndex&&(this.container.tabIndex=this.options.accessibility.container.tabIndex),this.options.accessibility.container.role&&this.container.setAttribute("role",this.options.accessibility.container.role),this.setChildNodesRoles(),this.container.addEventListener("focus",this.onContainerFocus,!1),this.otherNodes=[],document.addEventListener("selectionchange",this.onSelection,!1),this.container.addEventListener("touchcancel",this.cancel,!1),this.container.addEventListener("touchstart",this.onTouchStart,!1),this.container.addEventListener("touchmove",this.onTouchMove,!1),this.container.addEventListener("touchend",this.onTouchEnd,!1),this.container.addEventListener("mousedown",this.onMouseDown,!1)},detach(){this.cancel(),this.container.removeEventListener("mousedown",this.onMouseDown,!1),this.container.removeEventListener("touchend",this.onTouchEnd,!1),this.container.removeEventListener("touchmove",this.onTouchMove,!1),this.container.removeEventListener("touchstart",this.onTouchStart,!1),this.container.removeEventListener("touchcancel",this.cancel,!1),document.removeEventListener("selectionchange",this.onSelection,!1),!1!==this.options.accessibility.container.tabIndex&&this.container.removeAttribute("tabIndex"),this.options.accessibility.container.role&&this.container.removeAttribute("role"),this.unSetChildNodesRoles(),d--,!d&&u&&(u=!1,document.body.removeEventListener("touchstart",m,!1))},setState(t){if(this.state){if(this.state.ctor===t)return;this.state.leaveState&&this.state.leaveState.call(this)}const e=this.state,i=t.call(this);this.state===e&&(i.ctor=t,this.state=i)},findTargetNode(t){for(;t&&t.parentNode!==this.container;)t=t.parentNode;return t},onContainerFocus(t){t.stopPropagation(),this.setChildNodesRoles()},setChildNodesRoles(){const t=this.container.childNodes;for(let e=0;e<t.length;e++)1==t[e].nodeType&&(this.options.accessibility.items.role&&t[e].setAttribute("role",this.options.accessibility.items.role),!1!==this.options.accessibility.items.tabIndex&&(t[e].tabIndex=this.options.accessibility.items.tabIndex))},unSetChildNodesRoles(){const t=this.container.childNodes;for(let e=0;e<t.length;e++)1==t[e].nodeType&&(this.options.accessibility.items.role&&t[e].removeAttribute("role"),!1!==this.options.accessibility.items.tabIndex&&t[e].removeAttribute("tabIndex"))},onSelection(t){t.stopPropagation();const e=t.target===document||this.findTargetNode(t),i=/(iPhone|iPad|iPod)/i.test(navigator.userAgent)&&!/(Android|Windows)/i.test(navigator.userAgent);e&&(i?this.setState(this.states.idle):this.state.allowTextSelection||t.preventDefault())},addMouseHandlers(){this.mouseHandlersAttached||(this.mouseHandlersAttached=!0,document.documentElement.addEventListener("mouseleave",this.onMouseLeave,!1),window.addEventListener("mousemove",this.onMouseMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),window.addEventListener("blur",this.cancel,!1))},removeMouseHandlers(){this.mouseHandlersAttached&&(this.mouseHandlersAttached=!1,document.documentElement.removeEventListener("mouseleave",this.onMouseLeave,!1),window.removeEventListener("mousemove",this.onMouseMove,!0),window.removeEventListener("mouseup",this.onMouseUp,!0),window.removeEventListener("blur",this.cancel,!1))},onMouseLeave(t){t.stopPropagation(),this.usingTouch||t.target!==document.documentElement&&t.relatedTarget!==document.documentElement||this.state.onLeave&&this.state.onLeave.call(this)},onMouseDown(t){t.stopPropagation(),!this.usingTouch&&0==t.button&&this.setTarget(t)&&(this.addMouseHandlers(),this.canPreventScrolling=!0,this.startAtPosition({x:t.clientX,y:t.clientY,time:t.timeStamp}))},onTouchStart(t){t.stopPropagation(),this.usingTouch=!0,this.canPreventScrolling=!0,t.touches.length>1?this.setState(this.states.idle):this.setTarget(t)&&this.startAtPosition({x:t.touches[0].clientX,y:t.touches[0].clientY,time:t.timeStamp})},setTarget(t){const e=this.findTargetNode(t.target);if(!e)return this.setState(this.states.idle),!1;let{scrollContainer:i}=this.options;if(!i){const t=document.scrollingElement||document.documentElement;for(i=e.parentNode;i&&i!=t&&!(i!=document.body&&i.scrollHeight>i.clientHeight&&"visible"!=window.getComputedStyle(i)["overflow-y"]);)i=i.parentNode;i=i||t}return this.target={originalTarget:t.target,node:e,scrollContainer:i,origScrollTop:i.scrollTop,origScrollHeight:i.scrollHeight,baseTransform:p(e)},!0},startAtPosition(t){this.startPosition=this.previousPosition=this.latestPosition=t,this.setState(this.states.undecided)},updatePosition(t,e){null!=this.target&&(this.latestPosition=e,this.state.onMove&&!1===this.state.onMove.call(this)&&t.preventDefault(),this.latestPosition.time-this.previousPosition.time>100&&(this.previousPosition=this.latestPosition))},onMouseMove(t){t.stopPropagation(),this.updatePosition(t,{x:t.clientX,y:t.clientY,time:t.timeStamp})},onTouchMove(t){t.stopPropagation(),this.updatePosition(t,{x:t.touches[0].clientX,y:t.touches[0].clientY,time:t.timeStamp}),this.canPreventScrolling=!1},onMouseUp(t){t.stopPropagation(),this.usingTouch||0!==t.button||this.state.onEnd&&!1===this.state.onEnd.call(this)&&t.preventDefault()},onTouchEnd(t){t.stopPropagation(),t.touches.length>1?this.cancel():this.state.onEnd&&!1===this.state.onEnd.call(this)&&t.preventDefault()},getTotalMovement(){const t=this.target.scrollContainer.scrollTop-this.target.origScrollTop;return{x:this.latestPosition.x-this.startPosition.x,y:this.latestPosition.y-this.startPosition.y+t,time:this.latestPosition.time-this.startPosition.time}},getAbsoluteMovement(){const t=this.getTotalMovement();return{x:Math.abs(t.x),y:Math.abs(t.y),time:t.time,directionX:t.x<0?"left":"right",directionY:t.y<0?"up":"down"}},updateScrolling(){let t=0;const e=this.target.scrollContainer,i=e.getBoundingClientRect(),s=this.target.node.getBoundingClientRect(),o=Math.min(i.bottom,window.innerHeight)-s.bottom,n=s.top-Math.max(i.top,0),a=this.target.origScrollHeight-Math.min(e.clientHeight,window.innerHeight);o<40?t=Math.min(40,40-o):n<40&&(t=Math.max(-40,n-40)),e.scrollTop=Math.max(0,Math.min(a,e.scrollTop+t))},dispatch(t,e,i){let s=document.createEvent("CustomEvent");return s&&s.initCustomEvent?s.initCustomEvent(`slip:${e}`,!0,!0,i):(s=document.createEvent("Event"),s.initEvent(`slip:${e}`,!0,!0),s.detail=i),t.dispatchEvent(s)},getSiblings(t){const e=[];let i=t.node.nextSibling;for(;i;)1==i.nodeType&&e.push({node:i,baseTransform:p(i)}),i=i.nextSibling;return e},animateToZero(t,e){(e=e||this.target).node.style[n]=`${r} 0.1s ease-out`,e.node.style[a]=`translate(0,0) ${l}${e.baseTransform.value}`,setTimeout((()=>{e.node.style[n]="",e.node.style[a]=e.baseTransform.original,t&&t.call(this,e)}),101)},animateSwipe(t){const{target:e}=this,i=this.getSiblings(e),s=`translate(0,${this.target.height}px) ${l} `;e.node.style[n]="all 0.1s linear",e.node.style[a]=` translate(${this.getTotalMovement().x>0?"":"-"}100%,0) ${l}${e.baseTransform.value}`,setTimeout((()=>{t.call(this,e)&&(i.forEach((t=>{t.node.style[n]="",t.node.style[a]=s+t.baseTransform.value})),setTimeout((()=>{i.forEach((t=>{t.node.style[n]=`${r} 0.1s ease-in-out`,t.node.style[a]=`translate(0,0) ${l}${t.baseTransform.value}`})),setTimeout((()=>{i.forEach((t=>{t.node.style[n]="",t.node.style[a]=t.baseTransform.original}))}),101)}),1))}),101)}},"function"==typeof define&&define.amd&&define((()=>g)),"object"==typeof module&&module.exports&&(module.exports=g),g}();